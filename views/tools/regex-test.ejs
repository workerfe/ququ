<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>正则表达式测试工具 - 曲曲工具</title>
    <link rel="stylesheet" href="/stylesheets/style.css">
    <script>
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?10d3246e4c5febb42eff37771756238e";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
</head>
<body>
    <div class="tool-layout">
        <!-- 左侧导航 -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h1>曲曲工具</h1>
                <p>便捷的在线工具网站</p>
            </div>
            
            <nav class="sidebar-nav">
                <div class="nav-category">
                    <h3>文本处理工具</h3>
                    <ul class="nav-links">
                        <li><a href="/json-formatter">JSON 格式化</a></li>
                        <li><a href="/base64">Base64 编解码</a></li>
                        <li><a href="/url-encode">URL 编解码</a></li>
                    </ul>
                </div>
                
                <div class="nav-category">
                    <h3>开发工具</h3>
                    <ul class="nav-links">
                        <li><a href="/color-picker">颜色选择器</a></li>
                        <li><a href="/regex-test" class="active">正则表达式测试</a></li>
                        <li><a href="/hash-generator">Hash 生成器</a></li>
                    </ul>
                </div>
                
                <div class="nav-category">
                    <h3>生活工具</h3>
                    <ul class="nav-links">
                        <li><a href="/qr-code">二维码生成器</a></li>
                        <li><a href="/timestamp">时间戳转换</a></li>
                        <li><a href="/password-generator">密码生成器</a></li>
                    </ul>
                </div>
                
                <div class="nav-category">
                    <h3>其他</h3>
                    <ul class="nav-links">
                        <li><a href="/">返回首页</a></li>
                    </ul>
                </div>
            </nav>
        </div>

        <!-- 右侧内容区 -->
        <div class="tool-content">
            <div class="tool-header">
                <h1>正则表达式测试工具</h1>
                <p>测试和验证正则表达式</p>
            </div>

            <div class="tool-main">
                <div class="tool-container">
                    <div class="form-group">
                        <label for="regexInput">正则表达式：</label>
                        <input type="text" id="regexInput" placeholder="请输入正则表达式，如：\d+" oninput="testRegex()">
                    </div>
                    
                    <div class="form-group">
                        <label>修饰符：</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" id="flagG" onchange="testRegex()"> g (全局匹配)</label>
                            <label><input type="checkbox" id="flagI" onchange="testRegex()"> i (忽略大小写)</label>
                            <label><input type="checkbox" id="flagM" onchange="testRegex()"> m (多行模式)</label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="testString">测试字符串：</label>
                        <textarea id="testString" placeholder="请输入要测试的字符串" oninput="testRegex()"></textarea>
                    </div>

                    <div class="form-group">
                        <button onclick="testRegex()" class="btn">测试</button>
                        <button onclick="clearAll()" class="btn btn-secondary">清空</button>
                        <button onclick="loadExample()" class="btn btn-secondary">加载示例</button>
                    </div>

                    <div id="regexResult" class="result" style="display: none;"></div>
                    
                    <div class="examples">
                        <h3>常用正则表达式示例：</h3>
                        <div class="example-list">
                            <div class="example-item" onclick="setRegex('^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$', '邮箱验证')">
                                <strong>邮箱：</strong> ^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$
                            </div>
                            <div class="example-item" onclick="setRegex('^1[3-9]\\d{9}$', '手机号验证')">
                                <strong>手机号：</strong> ^1[3-9]\d{9}$
                            </div>
                            <div class="example-item" onclick="setRegex('^\\d{4}-\\d{2}-\\d{2}$', '日期格式')">
                                <strong>日期：</strong> ^\d{4}-\d{2}-\d{2}$
                            </div>
                            <div class="example-item" onclick="setRegex('^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)[a-zA-Z\\d]{8,}$', '强密码验证')">
                                <strong>强密码：</strong> ^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$
                            </div>
                            <div class="example-item" onclick="setRegex('^https?:\\/\\/[\\w\\-]+(\\.[\\w\\-]+)+([\\w\\-\\.,@?^=%&:/~\\+#]*[\\w\\-\\@?^=%&/~\\+#])?$', 'URL验证')">
                                <strong>URL：</strong> ^https?://[\w\-]+(\.[\w\-]+)+([\w\-\.,@?^=%&:/~\+#]*[\w\-\@?^=%&/~\+#])?$
                            </div>
                            <div class="example-item" onclick="setRegex('\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\b', 'IP地址')">
                                <strong>IP地址：</strong> \b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
      function testRegex() {
        const regexInput = document.getElementById('regexInput').value;
        const testString = document.getElementById('testString').value;
        const resultDiv = document.getElementById('regexResult');
        
        if (!regexInput.trim()) {
          resultDiv.style.display = 'none';
          return;
        }
        
        try {
          const flags = getFlags();
          const regex = new RegExp(regexInput, flags);
          
          const matches = testString.match(regex);
          const globalMatches = flags.includes('g') ? [...testString.matchAll(new RegExp(regexInput, flags))] : null;
          
          let resultHTML = '<h4>测试结果：</h4>';
          
          if (matches) {
            resultHTML += '<p style="color: #38a169; font-weight: 600;">✅ 匹配成功</p>';
            
            if (globalMatches && globalMatches.length > 0) {
              resultHTML += `<p><strong>找到 ${globalMatches.length} 个匹配项：</strong></p>`;
              globalMatches.forEach((match, index) => {
                resultHTML += `<p><strong>匹配 ${index + 1}:</strong> "${match[0]}" (位置: ${match.index})</p>`;
                if (match.length > 1) {
                  for (let i = 1; i < match.length; i++) {
                    resultHTML += `<p style="margin-left: 1rem;">分组 ${i}: "${match[i] || ''}"</p>`;
                  }
                }
              });
            } else {
              resultHTML += `<p><strong>匹配内容:</strong> "${matches[0]}"</p>`;
              if (matches.index !== undefined) {
                resultHTML += `<p><strong>匹配位置:</strong> ${matches.index}</p>`;
              }
              if (matches.length > 1) {
                resultHTML += '<p><strong>捕获分组:</strong></p>';
                for (let i = 1; i < matches.length; i++) {
                  resultHTML += `<p style="margin-left: 1rem;">分组 ${i}: "${matches[i] || ''}"</p>`;
                }
              }
            }
            
            // 高亮显示匹配的文本
            const highlightedText = highlightMatches(testString, regex);
            resultHTML += `<p><strong>高亮显示:</strong></p><div style="background: #f7fafc; padding: 1rem; border-radius: 4px; font-family: monospace; white-space: pre-wrap;">${highlightedText}</div>`;
          } else {
            resultHTML += '<p style="color: #e53e3e; font-weight: 600;">❌ 无匹配项</p>';
          }
          
          resultDiv.innerHTML = resultHTML;
          resultDiv.style.display = 'block';
          resultDiv.style.backgroundColor = '#f0fff4';
          resultDiv.style.borderColor = '#9ae6b4';
          
        } catch (error) {
          resultDiv.innerHTML = `<h4>错误：</h4><p style="color: #e53e3e;">❌ 正则表达式语法错误: ${error.message}</p>`;
          resultDiv.style.display = 'block';
          resultDiv.style.backgroundColor = '#fed7d7';
          resultDiv.style.borderColor = '#feb2b2';
        }
      }
      
      function getFlags() {
        let flags = '';
        if (document.getElementById('flagG').checked) flags += 'g';
        if (document.getElementById('flagI').checked) flags += 'i';
        if (document.getElementById('flagM').checked) flags += 'm';
        return flags;
      }
      
      function highlightMatches(text, regex) {
        return text.replace(regex, '<span style="background-color: #ffd700; padding: 2px 4px; border-radius: 3px;">$&</span>');
      }
      
      function setRegex(pattern, description) {
        document.getElementById('regexInput').value = pattern;
        document.getElementById('testString').value = getExampleText(description);
        testRegex();
      }
      
      function getExampleText(description) {
        const examples = {
          '邮箱验证': 'test@example.com\ninvalid-email\nuser.name+tag@domain.co.uk',
          '手机号验证': '13812345678\n1381234567\n+86 138 1234 5678',
          '日期格式': '2023-12-25\n2023/12/25\n23-12-25',
          '强密码验证': 'Password123\npassword\nPASSWORD123\nPass123!',
          'URL验证': 'https://www.example.com\nhttp://example.com/path?query=1\nftp://invalid-url',
          'IP地址': '192.168.1.1\n255.255.255.255\n192.168.1.256\n192.168.1'
        };
        return examples[description] || '请输入测试文本';
      }
      
      function loadExample() {
        document.getElementById('regexInput').value = '\\b\\w+@\\w+\\.\\w+\\b';
        document.getElementById('testString').value = '联系我们：admin@example.com 或 support@test.org';
        document.getElementById('flagG').checked = true;
        testRegex();
      }
      
      function clearAll() {
        document.getElementById('regexInput').value = '';
        document.getElementById('testString').value = '';
        document.getElementById('flagG').checked = false;
        document.getElementById('flagI').checked = false;
        document.getElementById('flagM').checked = false;
        document.getElementById('regexResult').style.display = 'none';
      }
    </script>
  </body>
</html>